{% extends 'core/base.html' %}
{% load static %}
{% load i18n %}
{% load l10n %}
{% block title %} Profile {% endblock %}

{% block content %}
<div class="container">
    <div class="row align-items-center">
        <div class="col-xl-12 col-lg-12 col-md-12 col-12">
            <!-- Bg -->
            <div class="pt-20 rounded-top"
                 style="background-color: blue; background-size: cover;">
            </div>
            <div class="card rounded-bottom smooth-shadow-sm">
                <div class="d-flex align-items-center justify-content-between
                  pt-4 pb-6 px-4">
                    <!-- avatar -->
                    <div class="d-flex align-items-center">
                        <div class="avatar-xxl avatar-indicators avatar-online me-2
                      position-relative d-flex justify-content-end
                      align-items-end mt-n10">
                            <img src="https://bootdey.com/img/Content/avatar/avatar1.png" class="avatar-xxl
                        rounded-circle border border-2 " alt="Image">
                            <a href="#!" class="position-absolute top-0 right-0 me-2">
                                <img src="https://dashui.codescandy.com/dashuipro/assets/images/svg/checked-mark.svg"
                                     alt="Image" class="icon-sm">
                            </a>
                        </div>
                        <!-- content -->
                        <div class="lh-1">
                            <h2 class="mb-0">{{ request.user.username }}
                                <a href="#!" class="text-decoration-none">
                                </a>
                            </h2>
                            <p class="mb-0 d-block">{{ request.user.email }}</p>
                        </div>
                    </div>
                    <div>
                        <!-- button -->
                        <a href="/user/profile/edit" class="btn btn-outline-primary
                      d-none d-md-block">Edit Profile</a>
                    </div>
                </div>
                <!-- nav -->
                <ul class="nav nav-lt-tab px-4" id="pills-tab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" href="#">Activity</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- page content -->
    <div class="py-6">
        <div class="row">
            <div class="offset-lg-1 col-lg-10 col-md-12 col-12">
                <!-- row -->
                <div class="row align-items-center mb-6">
                    <div class="col-lg-6 col-md-12 col-12">
                        <!-- form -->
                        <form>
                            <input type="search" class="form-control" placeholder="Search Your Activity">
                        </form>
                    </div>
                    <div class="col-lg-6 col-md-12 col-12 d-flex justify-content-end">
                        <!-- form -->
                        <div>
                            <a href="#!" class="btn btn-ghost btn-icon btn-sm rounded-circle texttooltip"
                               data-template="filterOne">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round" class="feather feather-filter icon-xs">
                                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                                </svg>
                                <div class="d-none" id="filterOne">
                                    <span>Filter</span>
                                </div>
                            </a>
                            <a href="#!" class="btn btn-outline-secondary ms-3">
                                Delete
                            </a>
                        </div>

                    </div>
                </div>
                <!-- hr -->

                <div class="mb-8">
                    <!-- card -->
                    <div class="">
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="activities-tab" data-bs-toggle="tab"
                                        data-bs-target="#activities" type="button" role="tab" aria-controls="activities"
                                        aria-selected="true">Activities
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="dashboard-tab" data-bs-toggle="tab"
                                        data-bs-target="#dashboard"
                                        type="button" role="tab" aria-controls="dashboard" aria-selected="false">
                                    Dashboard
                                </button>
                            </li>
                        </ul>
                    </div>
                    <!-- card -->
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="activities" role="tabpanel"
                             aria-labelledby="home-tab">
                            <div class="card">
                                <!-- list group -->
                                <ul class="list-group list-group-flush">
                                    <!-- list group item -->
                                    {% for result in all_result %}
                                    <li class="list-group-item p-3">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div class="d-flex align-items-center">
                                                <!-- img -->
                                                <div>
                                                    <img src="https://bootdey.com/img/Content/avatar/avatar1.png"
                                                         alt="Image"
                                                         class="avatar-sm rounded-circle">
                                                </div>
                                                <!-- content -->
                                                <div class="ms-3">
                                                    <p class="mb-0 font-weight-medium">
                                                        <a style="text-decoration: none; font-family: 'Montserrat', sans-serif;" href="{% url 'User:TestDetailView' result.id %}">{{ result.name }}</a> - <span style="font-weight: bold">Score: {{ result.score }}</span>
                                                        - <span style="font-style: italic">Date: {{ result.time_start }}</span>
                                                    </p>
                                                </div>
                                            </div>
                                            <div>
                                                <!-- dropdown -->
                                                <div class="dropdown dropstart">
                                                    <a href="#!" class="btn btn-ghost btn-icon btn-sm rounded-circle"
                                                       id="dropdownactivityOne" data-bs-toggle="dropdown"
                                                       aria-haspopup="true"
                                                       aria-expanded="false">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                             viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                             stroke-width="2" stroke-linecap="round"
                                                             stroke-linejoin="round"
                                                             class="feather feather-more-vertical icon-xs">
                                                            <circle cx="12" cy="12" r="1"></circle>
                                                            <circle cx="12" cy="5" r="1"></circle>
                                                            <circle cx="12" cy="19" r="1"></circle>
                                                        </svg>
                                                    </a>
                                                    <div class="dropdown-menu" aria-labelledby="dropdownactivityOne">
                                                        <a class="dropdown-item d-flex align-items-center"
                                                           href="#!">Action</a>
                                                        <a class="dropdown-item d-flex align-items-center" href="#!">Another
                                                            action</a>
                                                        <a class="dropdown-item d-flex align-items-center" href="#!">Something
                                                            else here</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </li>
                                    {% endfor %}
                                </ul>
                            </div>
                            {% if all_result %}
                            <div class="mt-4">
                                <nav class="pagination-outer" aria-label="Page navigation">
                                    <ul class="pagination">
                                        {% if previous %}
                                        <li class="page-item">
                                            <a href="{{ previous }}" class="page-link" aria-label="Previous">
                                                <span aria-hidden="true">«</span>
                                            </a>
                                        </li>
                                        {% endif %}
                                        {% for num in num_pages %}
                                        {% if num == page_number %}
                                        <li class="page-item active">
                                            <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                                        </li>
                                        {% elif num > page_number|add:'-3' and num < page_number|add:'3' %}
                                        <li class="page-item">
                                            <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                                        </li>
                                        {% endif %}
                                        {% endfor %}
                                        {% if next %}
                                        <li class="page-item">
                                            <a href="{{ next }}" class="page-link"
                                               aria-label="Next">
                                                <span aria-hidden="true">»</span>
                                            </a>
                                        </li>
                                        {% endif %}
                                    </ul>
                                </nav>
                            </div>
                            {% endif %}
                        </div>
                        <div class="tab-pane fade" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
                            <div class="mt-3">
                                <select class="form-select" id="selectTest" aria-label="select test">
                                    {% for test in all_test %}
                                    <option value="{{ test.id }}" {% if forloop.first %}selected{% endif %}>
                                        {{ test.name }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="row mt-3 mb-3 justify-content-center">
                                <div class="col-md-3">
                                    <div class="card-counter primary">
                                        <i class="fa fa-book"></i>
                                        <div class="count-wrapper">
                                            <span class="count-numbers" id="time-test"></span>
                                            <span class="count-name">Times</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="card-counter danger">
                                        <i class="fa fa-ticket"></i>
                                        <div class="count-wrapper">
                                            <span class="count-numbers" id="average-score"></span>
                                            <span class="count-name">Points</span>
                                        </div>
                                    </div>
                                </div>

<!--                                <div class="col-md-3">-->
<!--                                    <div class="card-counter success">-->
<!--                                        <i class="fa fa-database"></i>-->
<!--                                        <div class="count-wrapper">-->
<!--                                            <span class="count-numbers">6875</span>-->
<!--                                            <span class="count-name">Times</span>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->

<!--                                <div class="col-md-3">-->
<!--                                    <div class="card-counter info">-->
<!--                                        <i class="fa fa-users"></i>-->
<!--                                        <div class="count-wrapper">-->
<!--                                            <span class="count-numbers">35</span>-->
<!--                                            <span class="count-name">Users</span>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
                            </div>

                            <div>
                                <canvas id="scoreChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<link rel="stylesheet" href="{% static 'user/css/profile.css' %}">
<link rel="stylesheet" href="{% static 'user/css/pagination.css' %}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script type="text/javascript" src="{% static 'user/js/utils.js' %}"></script>
<script type="text/javascript" src="{% static 'user/js/chart.js' %}"></script>
<script>
    const actions = [
      {
        name: 'pointStyle: circle (default)',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'circle';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: cross',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'cross';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: crossRot',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'crossRot';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: dash',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'dash';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: line',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'line';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: rect',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'rect';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: rectRounded',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'rectRounded';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: rectRot',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'rectRot';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: star',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'star';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: triangle',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = 'triangle';
          });
          chart.update();
        }
      },
      {
        name: 'pointStyle: false',
        handler: (chart) => {
          chart.data.datasets.forEach(dataset => {
            dataset.pointStyle = false;
          });
          chart.update();
        }
      }
    ];
</script>
{% endblock %}